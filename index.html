button.addEventListener('click', moveButton); // For desktop click
button.addEventListener('touchstart', moveButton); // For mobile touch

function moveButton(event) {
    const rect = button.getBoundingClientRect();
    const buttonX = rect.left + rect.width / 2;
    const buttonY = rect.top + rect.height / 2;

    let mouseX, mouseY;
    
    if (event.type === 'touchstart') {
        mouseX = event.touches[0].clientX; // Get touch position
        mouseY = event.touches[0].clientY; // Get touch position
    } else {
        mouseX = event.clientX; // Get mouse position
        mouseY = event.clientY; // Get mouse position
    }

    const deltaX = mouseX - buttonX;
    const deltaY = mouseY - buttonY;

    // Apply movement
    let newLeft = button.offsetLeft + (mouseX < buttonX ? moveAmount : -moveAmount);
    let newTop = button.offsetTop + (mouseY < buttonY ? moveAmount : -moveAmount);

    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;
    const buttonWidth = button.offsetWidth;
    const buttonHeight = button.offsetHeight;

    // Ensure button stays within the viewport
    if (newLeft < 0) {
        newLeft = 0;
        newTop -= edgeDropAmount;
    } else if (newLeft + buttonWidth > viewportWidth) {
        newLeft = viewportWidth - buttonWidth;
        newTop -= edgeDropAmount;
    }
    if (newTop < 0) {
        newTop = 0;
        newLeft -= edgeDropAmount;
    } else if (newTop + buttonHeight > viewportHeight) {
        newTop = viewportHeight - buttonHeight;
        newLeft -= edgeDropAmount;
    }

    // Apply new position to the button
    button.style.left = `${newLeft}px`;
    button.style.top = `${newTop}px`;
}
